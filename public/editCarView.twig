{% include 'MainMenuView.twig' %}
    
    <main>
        <h1>Edit car</h1>
        <form class="edit" name="form" method="POST" action="/carEdited{{selectedCar.register_number}}" onsubmit="return validateForm();">
            <input type="text" name="registernumber" value="{{selectedCar.register_number}}" disabled><br>
            <select name="make">
                {% for make in makeArray %}
                    {% if make.make == selectedCar.make %}
                <option value="{{ make.make }}" selected>{{ make.make }}</option>
                    {% else %}
                <option value="{{ make.make }}">{{ make.make }}</option>
                    {% endif %}
                {% endfor %}
            </select><br>
            <select value="" name="color">
                {% for color in colorArray %}
                    {% if color.color == selectedCar.color %}
                <option value="{{ color.color }}" selected>{{ color.color }}</option>
                    {% else %}
                <option value="{{ color.color }}">{{ color.color }}</option>
                    {% endif %}
                {% endfor %}
            </select><br>
            <input type="text" name="year" value="{{selectedCar.year}}" maxlength="4"><br>
            <input type="text" name="price" value="{{selectedCar.price}}" maxlength="13"><br>
            <button type="submit" name="submit">Save changes</button>
        </form>
        <form class="edit" method="post" action="/cars">
            <button type="submit" name="submit">Discard changes</button>
        </form>
    </main>
<script> 
    function validateForm() {
        let make = document.forms["form"]["make"].value;
        if (make == "") {
            alert("You cannot leave your make field empty");
            return false;
        }
        let color = document.forms["form"]["color"].value;
        if (color == "") {
            alert("You cannot leave your color field empty");
            return false;
        }
        let year = document.forms["form"]["year"].value;
        if (year == "") {
            alert("You cannot leave your year field empty");
            return false;
        } else if (/^\d+$/.test(year) == false) {
                alert("The year must be a number");
                return false;
        } else if ((year >= 1900 && year <= 2019) == false) {
                alert("The year must be between 1900 and 2019");
                return false;
        }

        let price = document.forms["form"]["price"].value;
        if (price == "") {
            alert("You cannot leave your price field empty");
            return false;
        } else if (price <= 0) {
            alert("The price must be a positive number");
            return false;
        } else if (/^-?\d+\.?\d*$/.test(price) == false) {
            alert("The price must be a number. Decimal numbers should be written using a dot (.) as decimal separator");
            return false;
        }
    }
</script>